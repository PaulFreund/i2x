//###################################################################################################
// Basic Object
module.exports = (function ircHandler() {
    /////////////////////////////////////////////////////////////////////////////////////////////////
   
    var 
    ////=============================================================================================
    // Requirements
        
        events = require('events'),
        irc = require('irc'),
    
    ////=============================================================================================
    // Propertys
    
        _emitter = new events.EventEmitter(),
        _ircServer,
        _host,
        _port,
        _name,
        _channel,
    
    ////=============================================================================================
    // Methods
    
        ////-----------------------------------------------------------------------------------------
        // Function
        init = function(host, port, name, channel) {
            _host = host;
            _port = port;
            _name = name;
            _channel = channel;
            
            _ircServer = new irc.Client(_host, _name, {channels: [_channel]});
            _ircServer.addListener('message', onMessage);
            _ircServer.addListener('names', onNickList);        
        },
        
        onMessage = function(from, to, message) {
            //console.log(from+': '+message);
            _emitter.emit('message', from, to, message);
        },
        
        onNickList = function(channel, nicks) {
            //console.log('Nicks in '+channel+': '+nicks);
            //_emitter.emit('nicklist', channel, nicks);
        },
        
        send = function(message) {
            _ircServer.say(_channel, message);   
        }

    ////=============================================================================================
    ;

    /////////////////////////////////////////////////////////////////////////////////////////////////

    return {
        events:_emitter,
        init:init,
        send:send
    };
    
    /////////////////////////////////////////////////////////////////////////////////////////////////
}) ();
